---
title: "README"
output: github_document
bibliography: references.bib
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# `limitingDilutions`

Calculates the maximum likelihood estimate for a limiting dilution assay. Essentially a wrapper for the `SLDAssay` package [@trumble2017] that provides data formatting and results plotting.

**Statistics**:

-   `MLE`: Maximum likelihood estimate (MLE)

-   `BC_MLE`: Bias-corrected MLE

-   `Exact_PGOF`: P-value for goodness of fit. The probability of an experimental result as rare as or rarer than that obtained, assuming that the model is correct. Low values (e.g. \< 0.01) indicate rare or implausible experimental results. Samples with a very low values might be considered for retesting

-   `Asymp_PGOF`: P-value calculated using an asymptotic Chi-Squared distribution with D-1 degrees of freedom, where D is the number of dilution levels

-   `Exact_CI`: Exact confidence interval, computed from the likelihood ratio test (recommended)

-   `Asymp_CI`: Wald asymptotic confidence interval, based on the normal approximation to the binomial distribution

## Installation

You can install `limitingDilutions` from Github:

```{r eval=FALSE}
# install.packages("devtools")
devtools::install_github("stemcellbioengineering/limitingDilutions")
```

Dependencies are available on CRAN and will be automatically installed.

## How to use

Using `limitingDilutions` is easy. It minimally requires a `data.frame` containing a column of the dilutions tested and a column of cell counts. Each dilution should include several replicates. For details on designing limiting dilution assays, see [@dest.groth1982].

### For a single sample

First, load the `.csv` file.

```{r, echo=FALSE, results='asis'}
library(limitingDilutions)

fn <- system.file("extdata","lda.csv", package = "limitingDilutions")
df <- read.csv(fn)

knitr::kable(head(df,5))
```

Provide the data frame to `getMLE` along with the column names and desired cutoff threshold. Note the actual column names are user-defined - they can be anything you want. The results from `getMLE` can be visualized using `plotLDA`.

```{r, results='hide', message=TRUE, fig.width=4, fig.height=4}
results <- getMLE(df, 
                  counts = "count", 
                  dilutions = "dilution", 
                  cutoff = 25)

plotLDA(results, dilutions = "dilution")
```

### Providing a `.csv` file name rather than a data frame

Exactly like before, but providing the file name to be loaded by `getMLE`.

```{r, results='hide', message=TRUE, fig.width=4, fig.height=4}
results <- getMLE(fn, 
                  counts = "count", 
                  dilutions = "dilution", 
                  cutoff = 25)

plotLDA(results, dilutions = "dilution")
```

### Including a sample name

If our data frame contains a sample or group name, we can provide the column name to the `groupby` argument. The name will appear in results and be added to the plot.

```{r, results='hide', message=TRUE, fig.width=4, fig.height=4}
df[["sample"]] <- "SAMPLE"

results <- getMLE(df, 
                  counts = "count", 
                  dilutions = "dilution", 
                  groupby = "sample",
                  cutoff = 25)

plotLDA(results, dilutions = "dilution", groupby = "sample")
```

### Testing multiple samples

Use the `groupby` argument to specify the column containing the sample identifiers. Each sample will be tested individually. A plot will be generated for each sample.

```{r, results='hide', message=TRUE, fig.width=8, fig.height=4}
df1 <- read.csv(fn)
df1[["sample"]] <- "SAMPLE_A"

df2 <- read.csv(fn)
df2[["sample"]] <- "SAMPLE_B"

df <- dplyr::bind_rows(df1,df2)

results <- getMLE(df, 
                  counts = "count", 
                  dilutions = "dilution", 
                  groupby = "sample",
                  cutoff = 25)

plotLDA(results, dilutions = "dilution", groupby = "sample")
```

## License

This project is licensed under the GNU General Public License v3.0 - see the LICENSE file for details.

## References
